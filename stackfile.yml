accounting-nginx:
  image: nginx:latest
  ports:
    - "8000:8000"
  volumes:
    - /usr/lib/docker/volumes/accounting/nginx/conf:/etc/nginx/conf.d
    - /usr/lib/docker/volumes/accounting/dist:/dist
  links:
    - accounting
accounting-py:
  image: btobias92/accounting:1.0
  command: bash -c "python manage.py makemigrations && python manage.py migrate && gunicorn dj.wsgi -b 0.0.0.0:8000"
  links:
    - accounting-db
  volumes:
    - /usr/lib/docker/volumes/accounting/dist:/dist
  expose:
    - "8000"
accounting-db:
  image: postgres:latest


#### old

db:
  image: 'postgres:latest'
nginx:
  image: 'nginx:latest'
  links:
    - web
  ports:
    - '8000:8000'
  volumes:
    - '/usr/lib/docker/volumes/accounting/nginx/conf:/etc/nginx/conf.d'
    - '/usr/lib/docker/volumes/accounting/dist:/dist'
web:
  command: 'bash -c "python manage.py makemigrations && python manage.py migrate && gunicorn dj.wsgi -b 0.0.0.0:8000"'
  expose:
    - '8000'
  image: 'btobias92/accounting:1.0'
  links:
    - db
  volumes:
    - '/usr/lib/docker/volumes/accounting/dist:/dist'
